# User Service

Микросервис, отвечающий за управление пользователями (`User`). Он предоставляет API для создания, обновления, удаления и поиска пользователей, а также управление их ролями и аутентификацией.

## Архитектура

User Service является частью микросервисной архитектуры. Он работает на **FastAPI** и использует **PostgreSQL** как основную базу данных. Взаимодействие с базой данных выполняется асинхронно с помощью **SQLAlchemy**.

### **Основные компоненты:**
- **`user/`** - модуль, содержащий всю логику работы с пользователями.
- **`role/`** - модуль для управления ролями пользователей.
- **`user_role/`** - модуль для управления привязками пользователей к ролям.
- **`database.py`** – Подключение к базе данных. Управляет соединением с PostgreSQL.
- **`Dockerfile`** – Контейнеризация. Позволяет развернуть сервис в Docker.

## Описание файлов

### `main.py`

Основной файл сервиса, отвечающий за запуск FastAPI, регистрацию маршрутов и подключение к базе данных.

#### **Основные компоненты:**
- **Инициализация FastAPI** и регистрация API-маршрутов.
- **Запуск `lifespan`-функции** для создания таблиц в базе данных при старте сервиса.
- **Зависимость от `check_api_key`** для обеспечения безопасности API.

---

### `database.py`

Отвечает за создание подключения к базе данных и управление сессиями.

#### **Основные компоненты:**
- **Асинхронный движок SQLAlchemy** для работы с PostgreSQL.
- **Фабрика сессий (`async_sessionmaker`)** для управления транзакциями.
- **Функция `create_tables()`**, создающая таблицы в базе данных при запуске.

---

### `Dockerfile`

Определяет, как контейнеризуется User Service в среде Docker.

---

### `user/`

Модуль, содержащий всю логику работы с пользователями. Включает:

- Модель **`UserOrm`** для описания структуры данных.
- Функции в **`repository.py`** для работы с базой данных.
- API-маршруты в **`router.py`** для взаимодействия с пользователями.
- Логика аутентификации в **`auth.py`**.

Подробная информация в документации модуля **`user/`**.

---

### `role/`

Модуль, содержащий логику управления ролями пользователей. Включает:

- Модель **`RoleOrm`** для описания структуры данных.
- Функции в **`repository.py`** для работы с базой данных.
- API-маршруты в **`router.py`** для взаимодействия с пользователями.

Подробная информация в документации модуля **`role/`**.

---

### `user_role/`

Модуль, содержащий логику управления привязками пользователей к ролям. Включает:

- Модель **`UserRoleOrm`** для описания структуры данных.
- Функции в **`repository.py`** для работы с базой данных.
- API-маршруты в **`router.py`** для взаимодействия с пользователями.

Подробная информация в документации модуля **`user_role/`**.
