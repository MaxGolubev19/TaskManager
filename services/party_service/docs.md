# Документация Party Service

**Party Service** — это микросервис, отвечающий за управление командами пользователей. Он предоставляет API для создания, обновления, удаления и поиска команд (Party), а также обрабатывает бизнес-логику, связанную с этими сущностями.

## Архитектура Party Service

Party Service является частью микросервисной архитектуры. Он работает на **FastAPI** и использует **PostgreSQL** как основную базу данных. Взаимодействие с базой данных выполняется асинхронно с помощью **SQLAlchemy**.

### **Основные компоненты Party Service:**
- **`party/`** - модуль, содержащий всю логику работы с командами.
- **`database.py`** – Подключение к базе данных. Управляет соединением с PostgreSQL.
- **`Dockerfile`** – Контейнеризация. Позволяет развернуть сервис в Docker.

## Описание файлов

### `main.py`

Основной файл сервиса, отвечающий за запуск FastAPI, регистрацию маршрутов и подключение к базе данных.

#### **Основные компоненты:**
- **Инициализация FastAPI** и регистрация API-маршрутов.
- **Запуск `lifespan`-функции** для создания таблиц в базе данных при старте сервиса.
- **Зависимость от `check_api_key`** для обеспечения безопасности API.

---

### `database.py`

Отвечает за создание подключения к базе данных и управление сессиями.

#### **Основные компоненты:**
- **Асинхронный движок SQLAlchemy** для работы с PostgreSQL.
- **Фабрика сессий (`async_sessionmaker`)** для управления транзакциями.
- **Функция `create_tables()`**, создающая таблицы в базе данных при запуске.

---

### `models.py`

Определяет ORM-модель для таблицы `party`.

```python
class PartyOrm(Model):
    __tablename__ = "party"
    id: Mapped[int_pk]               # первичный ключ
    name: Mapped[str]                # название команды
    created_at: Mapped[created_at]   # автоматически устанавливаемая дата создания
    updated_at: Mapped[updated_at]   # автоматически устанавливаемая дата последнего обновления
```

---

### `Dockerfile`

Определяет, как контейнеризуется Party Service в среде Docker.

---

### `party/`

Модуль, содержащий всю логику работы с командами. Включает:

- Модель **`PartyOrm`** для описания структуры данных.
- Функции в **`repository.py`** для работы с базой данных.
- API-маршруты в **`router.py`** для взаимодействия с пользователями.

Подробная информация в документации модуля **`party/`**.